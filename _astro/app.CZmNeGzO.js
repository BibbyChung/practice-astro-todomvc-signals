import{r as a}from"./index.OX6ORIES.js";import{g as ee}from"./util.DiFbyzn0.js";import{t as g,a as te,g as k,b as ie,c as T,r as ne,s as re,d as oe,u as se,f as ue,e as ce}from"./todolist.service.Q-H-eumo.js";import{m as F}from"./map.BOKCRUkl.js";import{f as fe}from"./filter.BfNzDnkM.js";import"./innerFrom.-_aNtNEc.js";var I={exports:{}},$={};var le=a,ae=Symbol.for("react.element"),de=Symbol.for("react.fragment"),he=Object.prototype.hasOwnProperty,pe=le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ve={key:!0,ref:!0,__self:!0,__source:!0};function U(t,e,i){var n,s={},r=null,u=null;i!==void 0&&(r=""+i),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(u=e.ref);for(n in e)he.call(e,n)&&!ve.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:ae,type:t,key:r,ref:u,props:s,_owner:pe.current}}$.Fragment=de;$.jsx=U;$.jsxs=U;I.exports=$;var o=I.exports,me=Symbol.for("preact-signals");function V(){if(y>1)y--;else{for(var t,e=!1;S!==void 0;){var i=S;for(S=void 0,A++;i!==void 0;){var n=i.o;if(i.o=void 0,i.f&=-3,!(8&i.f)&&J(i))try{i.c()}catch(s){e||(t=s,e=!0)}i=n}}if(A=0,y--,e)throw t}}var c=void 0,S=void 0,y=0,A=0,N=0;function M(t){if(c!==void 0){var e=t.n;if(e===void 0||e.t!==c)return e={i:0,S:t,p:c.s,n:void 0,t:c,e:void 0,x:void 0,r:e},c.s!==void 0&&(c.s.n=e),c.s=e,t.n=e,32&c.f&&t.S(e),e;if(e.i===-1)return e.i=0,e.n!==void 0&&(e.n.p=e.p,e.p!==void 0&&(e.p.n=e.n),e.p=c.s,e.n=void 0,c.s.n=e,c.s=e),e}}function f(t){this.v=t,this.i=0,this.n=void 0,this.t=void 0}f.prototype.brand=me;f.prototype.h=function(){return!0};f.prototype.S=function(t){this.t!==t&&t.e===void 0&&(t.x=this.t,this.t!==void 0&&(this.t.e=t),this.t=t)};f.prototype.U=function(t){if(this.t!==void 0){var e=t.e,i=t.x;e!==void 0&&(e.x=i,t.e=void 0),i!==void 0&&(i.e=e,t.x=void 0),t===this.t&&(this.t=i)}};f.prototype.subscribe=function(t){var e=this;return z(function(){var i=e.value,n=c;c=void 0;try{t(i)}finally{c=n}})};f.prototype.valueOf=function(){return this.value};f.prototype.toString=function(){return this.value+""};f.prototype.toJSON=function(){return this.value};f.prototype.peek=function(){var t=c;c=void 0;try{return this.value}finally{c=t}};Object.defineProperty(f.prototype,"value",{get:function(){var t=M(this);return t!==void 0&&(t.i=this.i),this.v},set:function(t){if(t!==this.v){if(A>100)throw new Error("Cycle detected");this.v=t,this.i++,N++,y++;try{for(var e=this.t;e!==void 0;e=e.x)e.t.N()}finally{V()}}}});function ye(t){return new f(t)}function J(t){for(var e=t.s;e!==void 0;e=e.n)if(e.S.i!==e.i||!e.S.h()||e.S.i!==e.i)return!0;return!1}function L(t){for(var e=t.s;e!==void 0;e=e.n){var i=e.S.n;if(i!==void 0&&(e.r=i),e.S.n=e,e.i=-1,e.n===void 0){t.s=e;break}}}function q(t){for(var e=t.s,i=void 0;e!==void 0;){var n=e.p;e.i===-1?(e.S.U(e),n!==void 0&&(n.n=e.n),e.n!==void 0&&(e.n.p=n)):i=e,e.S.n=e.r,e.r!==void 0&&(e.r=void 0),e=n}t.s=i}function x(t){f.call(this,void 0),this.x=t,this.s=void 0,this.g=N-1,this.f=4}(x.prototype=new f).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===N))return!0;if(this.g=N,this.f|=1,this.i>0&&!J(this))return this.f&=-2,!0;var t=c;try{L(this),c=this;var e=this.x();(16&this.f||this.v!==e||this.i===0)&&(this.v=e,this.f&=-17,this.i++)}catch(i){this.v=i,this.f|=16,this.i++}return c=t,q(this),this.f&=-2,!0};x.prototype.S=function(t){if(this.t===void 0){this.f|=36;for(var e=this.s;e!==void 0;e=e.n)e.S.S(e)}f.prototype.S.call(this,t)};x.prototype.U=function(t){if(this.t!==void 0&&(f.prototype.U.call(this,t),this.t===void 0)){this.f&=-33;for(var e=this.s;e!==void 0;e=e.n)e.S.U(e)}};x.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var t=this.t;t!==void 0;t=t.x)t.t.N()}};Object.defineProperty(x.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var t=M(this);if(this.h(),t!==void 0&&(t.i=this.i),16&this.f)throw this.v;return this.v}});function be(t){return new x(t)}function W(t){var e=t.u;if(t.u=void 0,typeof e=="function"){y++;var i=c;c=void 0;try{e()}catch(n){throw t.f&=-2,t.f|=8,D(t),n}finally{c=i,V()}}}function D(t){for(var e=t.s;e!==void 0;e=e.n)e.S.U(e);t.x=void 0,t.s=void 0,W(t)}function xe(t){if(c!==this)throw new Error("Out-of-order effect");q(this),c=t,this.f&=-2,8&this.f&&D(this),V()}function j(t){this.x=t,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}j.prototype.c=function(){var t=this.S();try{if(8&this.f||this.x===void 0)return;var e=this.x();typeof e=="function"&&(this.u=e)}finally{t()}};j.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,W(this),L(this),y++;var t=c;return c=this,xe.bind(this,t)};j.prototype.N=function(){2&this.f||(this.f|=2,this.o=S,S=this)};j.prototype.d=function(){this.f|=8,1&this.f||D(this)};function z(t){var e=new j(t);try{e.c()}catch(i){throw e.d(),i}return e.d.bind(e)}var Y={exports:{}},G={};var b=a;function Se(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ge=typeof Object.is=="function"?Object.is:Se,je=b.useState,we=b.useEffect,Ee=b.useLayoutEffect,ke=b.useDebugValue;function Ne(t,e){var i=e(),n=je({inst:{value:i,getSnapshot:e}}),s=n[0].inst,r=n[1];return Ee(function(){s.value=i,s.getSnapshot=e,_(s)&&r({inst:s})},[t,i,e]),we(function(){return _(s)&&r({inst:s}),t(function(){_(s)&&r({inst:s})})},[t]),ke(i),i}function _(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!ge(t,i)}catch{return!0}}function $e(t,e){return e()}var Ce=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?$e:Ne;G.useSyncExternalStore=b.useSyncExternalStore!==void 0?b.useSyncExternalStore:Ce;Y.exports=G;var _e=Y.exports,H={};var Re=Symbol.for("react.fragment");H.Fragment=Re;H.jsxDEV=void 0;var Oe=Symbol.for("react.element"),P=function(){},h,Q=Symbol.dispose||Symbol.for("Symbol.dispose");function R(t,e){var i=e.effect.S();return h=e,Te.bind(e,t,i)}function Te(t,e){e(),h=t}var B,O;(B={u:0,effect:{s:void 0,c:function(){},S:function(){return P},d:function(){}},subscribe:function(){return P},getSnapshot:function(){return 0},S:function(){},f:function(){}})[Q]=function(){};var Fe=Promise.prototype.then.bind(Promise.resolve());function Ae(){O||(O=Fe(function(){var t;O=void 0,(t=h)==null||t.f()}))}function X(t){t===void 0&&(t=0),Ae();var e=a.useRef();e.current==null&&(e.current=function(n){var s,r,u,l,d=0,C=z(function(){r=this});return r.c=function(){d=d+1|0,l&&l()},(s={u:n,effect:r,subscribe:function(v){return l=v,function(){d=d+1|0,l=void 0,C()}},getSnapshot:function(){return d},S:function(){if(h!=null){var v=h.u,w=this.u;v==0&&w==0||v==0&&w==1?(h.f(),u=R(void 0,this)):v==1&&w==0||v==2&&w==0||(u=R(h,this))}else u=R(void 0,this)},f:function(){u?.(),u=void 0}})[Q]=function(){this.f()},s}(t));var i=e.current;return _e.useSyncExternalStore(i.subscribe,i.getSnapshot,i.getSnapshot),i.S(),i}Object.defineProperties(f.prototype,{$$typeof:{configurable:!0,value:Oe},type:{configurable:!0,value:function(t){var e=t.data,i=X(1);try{return e.value}finally{i.f()}}},props:{configurable:!0,get:function(){return{data:this}}},ref:{configurable:!0,value:null}});function Z(t){return X(t)}const Ve=new FinalizationRegistry(t=>{t.current?.()});function K(t,e){const i=a.useRef(null),n=a.useRef(!1);return n.current||(n.current=!0,Ve.register(n,i)),a.useMemo(()=>{i.current?.(),i.current=null;const[r,u]=t();return i.current=typeof u=="function"?u:null,r},e)}var m=function(t){return t[t.NoValue=0]="NoValue",t[t.Value=1]="Value",t[t.Error=2]="Error",t}(m||{});function E(t,e){return K(()=>{const i=ye({kind:m.Value,value:e?.initialValue}),n=t.subscribe({next:r=>{let u;try{typeof r=="object"&&r!==null?u=Array.isArray(r)?[...r]:{...r}:u=r}catch{u=r}i.value={kind:m.Value,value:u}},error:r=>{if(e?.rejectErrors)throw r;i.value={kind:m.Error,error:r}}}),s=()=>{n.unsubscribe()};return[be(()=>{const r=i.value;switch(r.kind){case m.Value:return r.value;case m.Error:throw r.error}}),s]},[])}const p=()=>K(()=>{const t=ee();return[t,()=>{t.complete()}]},[]);function De(){const t=a.useRef(null),e=p();return a.useEffect(()=>{const i=e.pipe(g(()=>{const n=t.current?.value??"";n!==""&&t.current&&(te(n??""),t.current.value="")})).subscribe();return()=>{i.unsubscribe()}},[]),o.jsxs("header",{className:"header",children:[o.jsx("h1",{children:"todos"}),o.jsx("form",{onSubmit:i=>{e.next(!0),i.preventDefault()},children:o.jsx("input",{className:"new-todo",placeholder:"What needs to be done?",autoFocus:!0,ref:t})})]})}function Pe(){Z();const t=p(),e=p(),i=E(k().pipe(F(r=>r.filter(l=>l.completed).length!==0))),n=E(k().pipe(F(r=>r.filter(u=>!u.completed).length))),s=E(ie());return a.useEffect(()=>{const r=t.pipe(T(()=>ne())).subscribe(),u=e.pipe(g(l=>re(l))).subscribe();return()=>{r.unsubscribe(),u.unsubscribe()}},[]),o.jsxs("footer",{className:"footer",children:[o.jsx("span",{children:n.value===1?"1 uncompleted item left":`${n.value} uncompleted items left`}),o.jsxs("ul",{className:"filters",children:[o.jsx("li",{children:o.jsx("a",{onClick:r=>{e.next("all"),r.preventDefault()},href:"#/",className:s.value==="all"?"selected":"",children:"All"})}),o.jsx("li",{children:o.jsx("a",{onClick:r=>{e.next("active"),r.preventDefault()},href:"#/",className:s.value==="active"?"selected":"",children:"Active"})}),o.jsx("li",{children:o.jsx("a",{onClick:r=>{e.next("completed"),r.preventDefault()},href:"#/",className:s.value==="completed"?"selected":"",children:"Completed"})})]}),o.jsx("div",{children:i.value?o.jsx("button",{onClick:r=>{t.next(!0)},className:"clear-completed",children:"Clear completed"}):""})]})}function Be(t){const e=p(),i=p();return a.useEffect(()=>{const n=e.pipe(g(()=>oe(t.id))).subscribe(),s=i.pipe(g(r=>{const u=JSON.parse(JSON.stringify(t));u.completed=r,se(u)})).subscribe();return()=>{n.unsubscribe(),s.unsubscribe()}},[]),o.jsx("li",{className:t.completed?"completed":"",children:o.jsxs("div",{className:"view",children:[o.jsx("input",{className:"toggle",type:"checkbox",checked:t.completed,onChange:n=>{i.next(n.target.checked)}}),o.jsx("label",{children:t.title}),o.jsx("button",{onClick:n=>{e.next(!0),n.preventDefault()},className:"destroy"})]})})}function Ie(){Z();const t=a.useRef(null),e=p(),i=p(),n=E(k());return a.useEffect(()=>{e.next(!0);const s=e.pipe(fe(u=>u),T(()=>k()),F(u=>{const l=u.length,d=u.filter(C=>C.completed).length;return l===0?!1:l===d}),g(u=>{t.current&&(t.current.checked=u)})).subscribe(),r=i.pipe(ue(1),T(()=>ce(t.current?.checked??!1))).subscribe();return()=>{s.unsubscribe(),r.unsubscribe()}},[]),o.jsxs("section",{className:"todoapp",children:[o.jsx(De,{}),o.jsxs("section",{className:"main",children:[o.jsx("input",{id:"toggle-all",className:"toggle-all",type:"checkbox",onChange:s=>{i.next(!0)},ref:t}),o.jsx("label",{htmlFor:"toggle-all",children:"Mark all as complete"}),o.jsx("ul",{className:"todo-list",children:n.value?.map((s,r)=>o.jsx(Be,{...s},s.id))})]}),o.jsx(Pe,{})]})}function ze(){return o.jsxs("div",{className:"min-w-2xl",children:[o.jsx(Ie,{}),o.jsxs("footer",{className:"info",children:[o.jsxs("p",{children:["Created by ",o.jsx("a",{href:"http://twitter.com/oscargodson",children:"Bibby"})]}),o.jsxs("p",{children:["Reference to ",o.jsx("a",{href:"http://todomvc.com",children:"TodoMVC"})]})]})]})}export{ze as default};
